{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="wthree_agile_admin_info">
		  <!-- /w3_agileits_top_nav-->
		  <!-- /nav-->
		  <div class="w3_agileits_top_nav">
			<ul id="gn-menu" class="gn-menu-main">
			  		 <!-- /nav_agile_w3l -->
				<li class="gn-trigger">
					<a class="gn-icon gn-icon-menu"><i class="fa fa-bars" aria-hidden="true"></i><span>Menu</span></a>
					<nav class="gn-menu-wrapper">
						<div class="gn-scroller scrollbar1">
							<ul class="gn-menu agile_menu_drop">
								<li><a href="#"> <i class="fa fa-tachometer"></i> Dashboard</a></li>
								<li><a href="#"> <i class="fa fa-tachometer"></i> FAQ </a></li>
							</ul>
						</div><!-- /gn-scroller -->
					</nav>
				</li>
				<!-- //nav_agile_w3l -->
				<li class="second logo"><h1><a href="#"><i class="fa fa-graduation-cap" aria-hidden="true"></i>Monitoring Tank </a></h1></li>
					<li class="second admin-pic">
				       <ul class="top_dp_agile">

						</ul>
				</li>




			</ul>
			<!-- //nav -->

		</div>
		<div class="clearfix"></div>
		<!-- //w3_agileits_top_nav-->
		<!-- /inner_content-->
				<div class="inner_content">

				    <!-- /inner_content_w3_agile_info-->
					<div class="inner_content_w3_agile_info">
						<!-- /agile_top_w3_grids-->
					   <div class="agile_top_w3_grids">
					          <ul class="ca-menu">
								<div class="col-md-3">
									<li>
										<a href="#">

											<i class="fa fa-flask" aria-hidden="true"></i>
											<div class="ca-content">
												<h4 class="ca-main">{{ pH_level }}</h4>
												<h3 class="ca-sub">pH Level</h3>
											</div>
										</a>
									</li>
								</div>
								<div class="col-md-3">
									<li>
										<a href="#">
										  <i class="fa fa-fire" aria-hidden="true"></i>
											<div class="ca-content">
												<h4 class="ca-main one">{{ temperature_level }}&#8451 </h4>
												<h3 class="ca-sub one">Temperature Level</h3>
											</div>
										</a>
									</li>
								</div>
									<div class="col-md-3">
									<li>
										<a href="#">
											<i class="fa fa-tachometer" aria-hidden="true"></i>
											<div class="ca-content">
											<h4 class="ca-main two">{{ fish_feed_grams }} grams</h4>
												<h3 class="ca-sub two">Fish Feeds(computed)</h3>
											</div>
										</a>
									</li>
								</div>
								<div class="col-md-3"  id="manual">

									<li>
										<a href="#">
											<i class="fa fa-anchor" aria-hidden="true"></i>
											<div class="ca-content">
												<h4 class="ca-main three">{{ water_level}}</h4>
												<h3 class="ca-sub three">WATER LEVEL</h3>
											</div>
										</a>
									</li>
								</div>
									<div class="clearfix"></div>
								</ul>
					   </div>
						 <div>
							 <div class="col-md-8">
							 <ul class="col-md-4">
							 	<button type="button" id="manual_feed"class="grow" style="background:#4d4dff; border-width:10px" value="feed">FEED</button>
							</ul>
							 <ul class="col-md-4">
							 	<button type="button" id="manual_status"class="grow" style="background:#4d4dff" value="status">STATUS</button>
							</ul>
							 <ul class="col-md-4">
							 	<button type="button" id="manual_pump"class="grow" style="background:#4d4dff" value="pump">PUMP</button>
							</ul>
						</div>
							<div class="col-md-4">
							 <ul class="col-md-6">
							 	<button type="button" id="manual_1_time" class="grow" style="background:#4d4dff" value="once">ONCE FEEDING</button>
							 </ul>
							 <ul class="col-md-6">
							 	<button type="button" id="manual_2_time" class="grow" style="background:#4d4dff" value="twice">TWICE FEEDING</button>
							 </ul>
						  </div>
						 </div>
					 <!-- //agile_top_w3_grids-->

						<!-- /agile_top_w3_post_sections-->
							<div class="agile_top_w3_post_sections">
							       <div class="col-md-6 agile_top_w3_post agile_info_shadow">
										   <div class="img_wthee_post">
										         <h3 class="w3_inner_tittle" style="color:black">Latest Report</h3>
												<div class="stats-wrap">
													<div class="count_info"><h4 class="count">65,800,587 </h4><span class="year" style="color:black">Total Ayungin</span></div>

													<div class="clearfix"></div>
												</div>
												<div class="stats-wrap">
													<div class="count_info"><h4 class="count" style="color:black">{{ fish_number}} </h4><span class="year" style="color:black">Total Ayungin in tank</span></div>
													<div class="year-info"><p class="text-no" style="color:black">{{ feeder_grams}} grams</p><span class="year" style="color:black">Feeder grams</span></div>
													<div class="clearfix"></div>
												</div>
												<div class="stats-wrap">
													<div class="count_info"><h4 class="count" style="color:black" id="last_update">{{ last_update }} </h4><span class="year" style="color:black">Last Update</span></div>
													<div class="year-info"><p class="text-no" style="color:black">{{ average_fishes_weight }}</p><span class="year" style="color:black">Average fish weight sampling</span></div>
													<div class="clearfix"></div>
												</div>
											</div>
									   </div>
									    <div class="col-md-6 agile_top_w3_post_info agile_info_shadow">
										    <div class="img_wthee_post1">
											<h3 class="w3_inner_tittle"> Latest Report hours ago :</h3>
										       	<div class="main-example">
													<div class="clock"></div>
													<div class="message"></div>

												</div>
											</div>
							            </div>
								       <div class="clearfix"></div>
							     </div>

						<!-- //agile_top_w3_post_sections-->
							<!-- /w3ls_agile_circle_progress-->
							<div class="w3ls_agile_cylinder chart agile_info_shadow">
							<h3 class="w3_inner_tittle two"> ph LEVEL CHART</h3>

									 <div id="chartdiv"></div>


							</div>

						<!-- /w3ls_agile_circle_progress-->
						<!-- /chart_agile-->
												<!-- /weather_w3_agile_info-->
						<div class="weather_w3_agile_info agile_info_shadow">
							<center>
								<div id="openweathermap-widget-11"></div>
							</center
						</div>
						<!-- //weather_w3_agile_info-->
						<!-- /social_media-->
						<div class="agile-tables">
							<div class="graph-form agile_info_shadow">
							 <h3 class="w3_inner_tittle two">Register a SMS Suscriber </h3>
									<div class="form-body">
										<strong style="font-size:120%">OPTION 1</strong>
										<ul style="font-size:120%">1. Subscribers need to text INFO to {{ sms_num}} (Cross-telco: {{ sms_num_cross_telco }})</ul>
										<ul style="font-size:120%">2. Upon receipt of the ‘welcome message’, the subscriber needs to reply YES</ul>
										<strong style="font-size:120%">OPTION 2</strong>
										<ul style="font-size:120%">1. Platform redirects your subscribers to this url: <a href="{{ register_url }}">{{ register_url }}</a> </ul>
										<ul style="font-size:120%">The page will then be redirected to the redirect uri of the application, and a ‘code’ parameter will be passed to it. </ul>
										<ul style="font-size:120%">The page will be redirected, and an SMS with confirmation code will be sent to the subscriber </ul>
										<ul style="font-size:120%">The subscriber needs to key-in on the page the received confirmation code and click the button Confirm to authorize the subscriber </ul>
									</div>

							</div>
							<div class="w3l-table-info agile_info_shadow">
							 <h3 class="w3_inner_tittle two">SMS Monitoring Suscribers</h3>
							 <form method="post">
								 {% csrf_token %}
								<table id="table">
								<thead>
									<tr>
									<th>Number</th>
									<th>Name</th>
									<th>Address</th>
									<th>Occupation/Role</th>
									</tr>
								</thead>
								<tbody>
									{% for sub in subscriber%}
									<tr>
										<td>
									 	{{ sub.subscriber_number}}
										<input type="hidden" name="id" value="{{ sub.id}}">
										</td>
										{% if sub.name %}
										<td><input type="text" name="name" class="form-control" value="{{sub.name}}"></td>
										{% else %}

										<td><input type="text" name="name" class="form-control" placeholder="Fill name"></td>
										{% endif %}
										{% if sub.address %}
										<td><input type="text" name="address" class="form-control" value="{{ sub.address }}"></td>
										{% else %}
										<td><input type="text" name="address" class="form-control" placeholder="Fill address"></td>
										{% endif %}
										{% if sub.role%}
										<td><input type="text" name="role" class="form-control" value="{{ sub.role }}"></td>
										{% else %}
										<td><input type="text" name="role" class="form-control" placeholder="Fill role"></td>
										{% endif %}
									</tr>
										 {% endfor %}
									<tr>
										<td><button type="submit" class="btn btn-default">SAVE</button></td>
									</tr>
								</tbody>

								</table>
							</form>
					</div>
					<div class="w3l-table-info agile_info_shadow">
					 <h3 class="w3_inner_tittle two">AUTOMATED FISH FEEDER</h3>
					 <div class="w3agile-validation">
					 <div class="agile-validation agile_info_shadow">
							 <div class="my-div">

									 {% csrf_token %}
									 <label >Fish population &nbsp;<span class="at-required-highlight">*</span></label>
									 <div class="form-group">
										 <input type="number" name="" id="population" required="true" class="form-control" value="{{ fish_number}}">
									 </div>
									 <label >Average weight sampling result (required)&nbsp;<span class="at-required-highlight">*</span></label>
									 <div class="form-group">
										 <input type="number" step="0.01" name="" id="weight" required="true" class="form-control" value="{{ average_fishes_weight }}">
									 </div>
									 <label>Feeder grams &nbsp;<span class="at-required-highlight">*</span></label>
									 <div class="form-group">
										 <input type="number" step="0.01" name="" id="grams" required="true" class="form-control" value="{{ feeder_grams }}">
									 </div>
									 <label>Feed grams calculated  (change if you want manual feed)&nbsp;<span class="at-required-highlight">*</span></label>
										<div class="form-group">
										<input type="number" step="0.01" name="" id="times" class="form-control" placeholder="{{ fish_feed_grams }}">
									 </div>
									 <p>
									 <hr>
										 <input type="submit" name="sub-1"id="submitfeed" value="Submit" class="btn btn-primary">
									 </p>

							 </div>
						 </div>
					 </div>
				  </div>
						<!-- //social_media-->
				    </div>
					<!-- //inner_content_w3_agile_info-->
				</div>
		<!-- //inner_content-->
	</div>
<!-- banner -->
<!--copy rights start here-->
<div class="copyrights">
	 <p>© 2017 Esteem. All Rights Reserved | Design by  <a href="http://w3layouts.com/" target="_blank">W3layouts</a> </p>
</div>
<!--copy rights end here-->

{% endblock content %}
{% block body_scripts %}
<script type="text/javascript" src="{% static "js/jquery-2.1.4.min.js" %}"></script>

	<!-- /amcharts -->
				<script src="{% static "js/amcharts.js" %}"></script>
		    <script src="{% static "js/serial.js" %}"></script>
				<!--<script src="{% static "js/export.js" %}"></script>-->
				<script src="{% static "js/light.js" %}"></script>
				<!-- Chart code -->
	 <script>
var chart = AmCharts.makeChart("chartdiv", {
    "theme": "light",
    "type": "serial",
    "startDuration": 3,
    "dataProvider": [
			{% for report in reports %}
			{
				"country": "{{report.created_time}}",
				"visits": "{{report.pH_level}}",
				"color": "#0D8ECF"
			},
			{% endfor %}
			],
    "valueAxes": [{
        "position": "left",
        "axisAlpha":0,
        "gridAlpha":0
    }],
    "graphs": [{
        "balloonText": "[[category]]: <b>[[value]]</b>",
        "colorField": "color",
        "fillAlphas": 0.85,
        "lineAlpha": 0.1,
        "type": "column",
        "topRadius":1,
        "valueField": "visits"
    }],
    "depth3D": 40,
	"angle": 30,
    "chartCursor": {
        "categoryBalloonEnabled": false,
        "cursorAlpha": 0,
        "zoomable": false
    },
    "categoryField": "country",
    "categoryAxis": {
        "gridPosition": "start",
        "axisAlpha":0,
        "gridAlpha":0

    },
    "export": {
    	"enabled": false
     }

}, 0);
</script>

	<!-- //amcharts -->

		<script src="{% static "js/Chart.min.js" %}"></script>
		<script src="{% static "js/modernizr.custom.js" %}"></script>

		<script src="{% static "js/classie.js" %}"></script>
		<script src="{% static "js/gnmenu.js" %}"></script>
		<script>
			new gnMenu( document.getElementById( 'gn-menu' ) );
		</script>
			<!-- script-for-menu -->


	<!--skycons-icons-->
	<script src='https://openweathermap.org/themes/openweathermap/assets/vendor/owm/js/d3.min.js'></script><script>window.myWidgetParam ? window.myWidgetParam : window.myWidgetParam = [];  window.myWidgetParam.push({id: 11,cityid: '1683319',appid: '9a097bc5403e7ab3dfeaefcf7081130f',units: 'metric',containerid: 'openweathermap-widget-11',  });  (function() {var script = document.createElement('script');script.async = true;script.charset = "utf-8";script.src = "https://openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator-2.0.js";var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(script, s);  })();</script>
<!--//skycons-icons-->
<!-- //js -->

		<script src="{% static "js/flipclock.js" %}"></script>

	<script type="text/javascript">
		var clock;

		var update = new Date("{{ last_update }}");

		var now_date = new Date();

		$("#last_update" ).text( now_date.toLocaleString());

		var hours = Math.abs(now_date - update) / 36e5;
		diff = now_date.valueOf() - update.valueOf();
		var dura = diff/1000;
		$(document).ready(function() {
			clock = $('.clock').FlipClock(dura,{
		    });
		});
	</script>
<script src="{% static "js/bars.js" %}"></script>

<script src="{% static "js/scripts.js" %}"></script>

<script type="text/javascript" src="{% static "js/bootstrap-3.1.1.min.js" %}"></script>
<script type="text/javascript" src="{% static "js/jquery.basictable.min.js" %}"></script>
<script type="text/javascript">
    $(document).ready(function() {
      $('#table').basictable();

      $('#table-breakpoint').basictable({
        breakpoint: 768
      });

      $('#table-swap-axis').basictable({
        swapAxis: true
      });

      $('#table-force-off').basictable({
        forceResponsive: false
      });

      $('#table-no-resize').basictable({
        noResize: true
      });

      $('#table-two-axis').basictable();

      $('#table-max-height').basictable({
        tableWrapper: true
      });
    });
</script>
<!-- input-forms -->
	<script type="text/javascript" src="{% static 'js/valida.2.1.6.min.js' %}"></script>
	<script type="text/javascript" >

		$(document).ready(function() {

			// show Valida's version.
			$('#version').valida( 'version' );

			// Exemple 1
			$('.valida').valida();

			// Exemple 2
			/*
			$('.valida').valida({

				// basic settings
				validate: 'novalidate',
				autocomplete: 'off',
				tag: 'p',

				// default messages
				messages: {
					submit: 'Wait ...',
					required: 'Este campo é obrigatório',
					invalid: 'Field with invalid data',
					textarea_help: 'Digitados <span class="at-counter">{0}</span> de {1}'
				},

				// filters & callbacks
				use_filter: true,

				// a callback function that will be called right before valida runs.
				// it must return a boolan value (true for good results and false for errors)
				before_validate: null,

				// a callback function that will be called right after valida runs.
				// it must return a boolan value (true for good results and false for errors)
				after_validate: null

			});
			*/

			// setup the partial validation
			$('#partial-1').on('click', function( ev ) {
				ev.preventDefault();
				$('#res-1').click(); // clear form error msgs
				$('form').valida('partial', '#field-1'); // validate only field-1
				$('form').valida('partial', '#field-1-3'); // validate only field-1-3
			});

		});

	</script>
	<!-- //input-forms -->
	<!--validator js-->
	<script src="{% static 'js/validator.min.js' %}"></script>

	<script type="text/javascript">
	var form = document.getElementById("feeder");

	document.getElementById("submitfeed").addEventListener("click", function () {
		var population = $( "#population" ).val();
		var weight = $( "#weight" ).val();
		var grams = $( "#grams" ).val();
		var times = $( "#times" ).val();
		var msg="";
		if (population){
			msg+=" 'population': ' " + population + "' ,"
		}
		if (weight){
			msg+=" 'weight': ' " + weight + "' ,"
		}
		if (grams){
			msg+=" 'grams': ' " + grams + "' ,"
		}
		if (times){
			msg=" 'feed': ' " + times + "' ,"
		}
		alert(msg);
		$.post("/v1/smsreciever/",
		{
			"csrfmiddlewaretoken": "{{ csrf_token }}",

			  'inboundSMSMessageList': {
			      'inboundSMSMessage': [
			         {
								 "message" : msg,
			         }
			       ],
			   }


		},
		function(data, status){

		});
		window.location = "/#manual";
		location.reload();
	});
	</script>
	<script>
	function send(data){
		alert("Are you sure you want to continue?")
		$.post("/v1/smsreciever/",
			{
				"csrfmiddlewaretoken": "{{ csrf_token }}",
				'manual': data,
			}
		);
		window.location = "/#manual";
	}
  $(document).ready(function(){
    $('#manual_feed').click(function(){
       send($('#manual_feed').val());
    });
		$('#manual_status').click(function(){
       send($('#manual_status').val());
    });
		$('#manual_pump').click(function(){
       send($('#manual_pump').val());
    });
		$('#manual_1_time').click(function(){
       send($('#manual_1_time').val());
    });
		$('#manual_2_time').click(function(){
       send($('#manual_2_time').val());
    });
  });
	</script>
{% endblock body_scripts %}
